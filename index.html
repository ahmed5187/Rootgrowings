<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>RootGrowings</title>

  <link rel="icon" href="assets/favicon.png" type="image/png">
  <link rel="manifest" href="manifest.json">
  <meta name="theme-color" content="#0b6b2f">
  <style>
    * { box-sizing: border-box; }
    :root { --green:#0b6b2f; --green2:#2e7d4e; --bg:#f6f8f7; --ink:#0b2d18; --muted:#4a7c63; }
    body { margin:0; font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial; background:var(--bg); color:var(--ink); }

    /* Header */
    header { position:sticky; top:0; background:var(--bg); padding:8px 12px; display:flex; align-items:center; gap:10px; border-bottom:1px solid #e2eee7; z-index:3; }
    header img.logo { height:28px; width:auto; }
    header .spacer { flex:1; }
    .iconBtn { width:36px; height:36px; border-radius:10px; background:#e9f3ed; color:var(--green); border:0; display:grid; place-items:center; cursor:pointer; }
    .iconBtn svg{ width:18px; height:18px; }

    /* Hero – taller */
    .hero { width:100%; max-height:220px; overflow:hidden; border-bottom:1px solid #e2eee7; }
    .hero img { width:100%; height:auto; display:block; object-fit:cover; }

    main { padding:10px 12px 92px; max-width:980px; margin:0 auto; text-align:center; }
    h1.title { margin:12px 2px 8px; font-size:22px; font-weight:800; color:var(--green); letter-spacing:.3px; }

    .section { margin:14px 0 22px; }
    .section h3 { margin:10px 4px; font-size:15px; color:#4a7c63; font-weight:800; display:flex; align-items:center; gap:8px; justify-content:center; }
    .roomIcon { width:18px; height:18px; display:inline-grid; place-items:center; background:#eaf5ef; border-radius:6px; font-size:12px; }
    .group { background:#eaf5ef; border-radius:16px; padding:12px; }
    .row { display:grid; grid-template-columns:repeat(auto-fill,minmax(200px,1fr)); gap:14px; place-items:center; }
    .card { width:100%; max-width:260px; background:#fff; border-radius:16px; padding:10px; box-shadow:0 2px 10px rgba(0,0,0,.05); display:grid; gap:8px; align-content:start; position:relative; text-align:center; cursor:pointer; }
    .photoWrap { position:relative; }
    .photo { width:100%; aspect-ratio:1/1; border-radius:12px; background:#e8efe9 center/cover no-repeat; }
    .ring { position:absolute; top:8px; left:8px; width:42px; height:42px; border-radius:50%; background:conic-gradient(var(--green2) var(--pct), #e5ece7 0); display:grid; place-items:center; font-size:11px; font-weight:700; color:var(--green); }
    .ring span { background:#fff; width:30px; height:30px; border-radius:50%; display:grid; place-items:center; }
    .gear { position:absolute; top:8px; right:8px; width:28px; height:28px; border-radius:50%; border:0; background:#ffffffcc; display:grid; place-items:center; cursor:pointer; }
    .gear svg { width:16px; height:16px; color:#4a7c63; }
    .name { font-weight:800; font-size:14px; }
    .nick { color:#46795b; font-size:12px; }
    .meta { font-size:11px; color:#355747; }
    .actions { display:grid; grid-template-columns:1fr 1fr; gap:8px; }
    .btn { border:0; padding:8px 12px; border-radius:10px; cursor:pointer; font-weight:700; }
    .btn.primary { background:var(--green); color:#fff; }
    .btn.ghost { background:#eef4f0; color:var(--ink); }
    .empty { text-align:center; color:#507a65; padding:40px 10px; }

    /* Bottom nav */
    nav { position:fixed; bottom:0; left:0; right:0; background:#fff; border-top:1px solid #e2eee7; display:grid; grid-template-columns:repeat(4,1fr); padding:8px 10px; z-index:5; }
    nav button { background:transparent; border:0; padding:8px; font-size:12px; color:#4a7c63; display:grid; place-items:center; gap:4px; cursor:pointer; }
    .navIcon { width:22px; height:22px; }
    .active { color:var(--green); font-weight:800; }

    .page { display:none; }
    .page.active { display:block; }

    .settings { display:grid; gap:12px; text-align:center; }
    .btnRow { display:flex; gap:10px; flex-wrap:wrap; justify-content:center; }
    .row2 { display:grid; grid-template-columns:1fr 1fr; gap:10px; }
    input, select { width:100%; padding:10px; border:1px solid #cfe0d6; border-radius:8px; }
    label { font-size:12px; color:#355747; }

    dialog { border:0; border-radius:14px; width:min(540px,92vw); }
    menu { display:flex; justify-content:center; gap:8px; }
    .iconGrid { display:grid; grid-template-columns:repeat(8,1fr); gap:8px; }
    .iconPick { border:1px solid #cfe0d6; border-radius:8px; padding:6px; cursor:pointer; background:#fff; }
    .iconPick.selected { outline:2px solid var(--green); }

    /* Confirmation */
    #toastDialog::backdrop { background:rgba(0,0,0,.15); }
    .toastBox { display:grid; place-items:center; gap:10px; text-align:center; padding:18px; }
    .toastIcon { width:34px; height:34px; border-radius:999px; background:#e6f4ea; color:var(--green); display:grid; place-items:center; }
    .toastMsg { color:#264d36; font-weight:700; }

    /* Profile */
    #profileDialog::backdrop { background:rgba(0,0,0,.2); }
    .avatar { width:64px; height:64px; border-radius:50%; object-fit:cover; border:3px solid #e6f4ea; }
    .muted { color:var(--muted); font-size:12px; }

    /* Plant details */
    #plantDetailsDialog::backdrop { background:rgba(0,0,0,.2); }
    .detailsImg { width:100%; aspect-ratio:16/9; border-radius:12px; background:#e8efe9 center/cover no-repeat; }

    /* Insights */
    .chartCard { background:#fff; border-radius:16px; padding:14px; box-shadow:0 2px 10px rgba(0,0,0,.05); margin-bottom:14px; text-align:center; }
    .chartTitle { font-weight:800; color:#355747; margin-bottom:10px; }
    .chartWrap { width:100%; overflow:auto; }
    svg.chart { max-width:100%; height:160px; }
  </style>
</head>
<body>
  <header>
    <img class="logo" src="assets/RGlogo.png" alt="RootGrowings">
    <div class="spacer"></div>
    <button id="plusBtn" class="iconBtn" title="Add">
      <svg viewBox="0 0 24 24"><path d="M11 5h2v6h6v2h-6v6h-2v-6H5v-2h6z" fill="currentColor"/></svg>
    </button>
    <button id="profileBtn" class="iconBtn" title="Profile">
      <svg viewBox="0 0 24 24"><path d="M12 12a5 5 0 1 0-5-5 5 5 0 0 0 5 5Zm0 2c-4 0-8 2-8 5v1h16v-1c0-3-4-5-8-5Z" fill="currentColor"/></svg>
    </button>
  </header>

  <div class="hero">
    <img src="assets/hero.jpg" alt="">
  </div>

  <main>
    <h1 class="title" id="homeTitle">My Plants</h1>
    <section id="homePage" class="page active">
      <div id="homeContent"></div>
      <div class="empty" id="homeEmpty" hidden>
        Add your first plant from the plus button then come back here.
      </div>
    </section>

    <h1 class="title" id="settingsTitle" style="display:none">My Settings</h1>
    <section id="settingsPage" class="page">
      <div class="settings">
        <h3>Rooms</h3>
        <div class="btnRow">
          <button class="btn primary" id="btnAddRoom">Add a Room</button>
          <button class="btn ghost" id="btnEditRoom">Edit a Room</button>
          <button class="btn ghost" id="btnRemoveRoom">Remove a Room</button>
        </div>

        <h3>Plants</h3>
        <div class="btnRow">
          <button class="btn primary" id="btnAddPlant">Add a Plant</button>
          <button class="btn ghost" id="btnEditPlant">Edit a Plant</button>
          <button class="btn ghost" id="btnRemovePlant">Remove a Plant</button>
        </div>
      </div>
    </section>

    <h1 class="title" id="insightsTitle" style="display:none">Insights</h1>
<section id="insightsPage" class="page">
  <div class="chartCard">
    <div class="chartTitle">Waterings — last 14 days</div>
    <div class="chartWrap"><svg id="chart14Water" class="chart" viewBox="0 0 560 160"></svg></div>
  </div>
  <div class="chartCard">
    <div class="chartTitle">Fertilizer — last 14 days</div>
    <div class="chartWrap"><svg id="chart14Fert" class="chart" viewBox="0 0 560 160"></svg></div>
  </div>
  <div class="chartCard">
    <div class="chartTitle">Waterings per plant</div>
    <div class="chartWrap"><svg id="chartByPlant" class="chart" viewBox="0 0 560 160"></svg></div>
  </div>
  <div class="chartCard">
    <div class="chartTitle">Waterings per room</div>
    <div class="chartWrap"><svg id="chartByRoomWater" class="chart" viewBox="0 0 560 160"></svg></div>
  </div>
  <div class="chartCard">
    <div class="chartTitle">Fertilizer per room</div>
    <div class="chartWrap"><svg id="chartByRoomFert" class="chart" viewBox="0 0 560 160"></svg></div>
  </div>
</section>

  </main>

  <nav>
    <button id="navSettings">
      <svg class="navIcon" viewBox="0 0 24 24"><path d="M12 8a4 4 0 1 0 0 8 4 4 0 0 0 0-8Zm9.4 4a7.4 7.4 0 0 0-.1-1l2-1.6-2-3.5-2.4 1a7.5 7.5 0 0 0-1.7-1l-.4-2.6H9.2l-.4 2.6c-.6.2-1.2.5-1.7 1l-2.4-1-2 3.5 2 1.6a7.4 7.4 0 0 0-.1 1c0 .3 0 .7.1 1l-2 1.6 2 3.5 2.4-1c.5.4 1.1.7 1.7 1l.4 2.6h5.6l.4-2.6c.6-.2 1.2-.5 1.7-1l2.4 1 2-3.5-2-1.6c.1-.3.1-.6.1-1Z" fill="currentColor"/></svg>
      <span>Settings</span>
    </button>
    <button id="navHome" class="active">
      <svg class="navIcon" viewBox="0 0 24 24"><path d="M12 3 2 11h3v10h6V15h2v6h6V11h3L12 3Z" fill="currentColor"/></svg>
      <span>Home</span>
    </button>
    <button id="navInsights">
      <svg class="navIcon" viewBox="0 0 24 24"><path d="M3 13h4v8H3v-8Zm7-6h4v14h-4V7Zm7-4h4v18h-4V3Z" fill="currentColor"/></svg>
      <span>Insights</span>
    </button>
    <button id="navChat">
      <svg class="navIcon" viewBox="0 0 24 24"><path d="M4 4h16v10H7l-3 3V4Z" fill="currentColor"/></svg>
      <span>Chat</span>
    </button>
  </nav>

  <!-- Confirmation -->
  <dialog id="toastDialog">
    <div class="toastBox">
      <div class="toastIcon">
        <svg width="18" height="18" viewBox="0 0 24 24"><path fill="currentColor" d="M9.5 16.2 5.3 12l1.4-1.4 2.8 2.8 7.8-7.8L18.7 7z"/></svg>
      </div>
      <div id="toastMsg" class="toastMsg">Saved</div>
      <menu><button class="btn primary" id="toastOk">OK</button></menu>
    </div>
  </dialog>

  <!-- Ask Notifications -->
  <dialog id="notifyDialog">
    <form method="dialog" style="padding:16px; text-align:center">
      <h3 style="margin:0 0 8px; color:#14532d">Enable Notifications</h3>
      <p class="muted">We’ll remind you exactly when it’s time to water or fertilize.</p>
      <menu style="margin-top:10px">
        <button id="notifyLater" type="button" class="btn ghost">Later</button>
        <button id="notifyAllow" type="button" class="btn primary">Allow</button>
      </menu>
    </form>
  </dialog>

  <!-- Profile -->
  <dialog id="profileDialog">
    <form id="profileForm" method="dialog" style="padding:18px 18px 10px;">
      <div style="display:grid; place-items:center; gap:8px; text-align:center">
        <img id="profileAvatar" class="avatar" src="assets/RGicon.jpg" alt="">
        <div style="font-weight:800" id="profileName">User</div>
        <div class="muted" id="profileEmail">email@example.com</div>
      </div>
      <div style="margin-top:12px" class="row2">
        <div>
          <label>Display name</label>
          <input id="displayNameInput" placeholder="Your name">
        </div>
        <div>
          <label>Upload new photo (optional)</label>
          <input id="photoFileInput" type="file" accept="image/*">
        </div>
      </div>
      <menu style="margin-top:12px">
        <button type="button" id="signOutBtn" class="btn ghost" style="margin-right:auto">Sign Out</button>
        <button type="button" id="closeProfile" class="btn ghost">Close</button>
        <button type="submit" class="btn primary">Save</button>
      </menu>
    </form>
  </dialog>

  <!-- Plant Details -->
  <dialog id="plantDetailsDialog">
    <div style="padding:16px">
      <div id="detailsImage" class="detailsImg"></div>
      <h3 id="detailsTitle" style="margin:12px 0 6px">Plant</h3>
      <div id="detailsMeta" class="muted" style="margin-bottom:12px">Room • Next due • Last watered</div>
      <menu>
        <button type="button" id="detailsDeleteBtn" class="btn ghost" style="margin-right:auto">Delete</button>
        <button type="button" id="detailsFertBtn" class="btn ghost">Fertilize</button>
        <button type="button" id="detailsCloseBtn" class="btn ghost">Close</button>
        <button type="button" id="detailsEditBtn" class="btn primary">Edit</button>
      </menu>
    </div>
  </dialog>

  <!-- Plant & Room dialogs -->
  <dialog id="plantDialog">
    <form id="plantForm" method="dialog">
      <h3 id="plantDialogTitle">Add plant</h3>

      <div class="row2">
        <div><label>Name</label><input name="name" required placeholder="Monstera"></div>
        <div><label>Nickname</label><input name="nickname" placeholder="Mo"></div>
      </div>

      <label>Photo</label>
      <input name="photo" type="file" accept="image/*">

      <div class="row2">
        <div><label>Plant type</label><input name="plantType" placeholder="Monstera deliciosa"></div>
        <div><label>Room</label><select name="location" id="roomSelect"></select></div>
      </div>

      <div class="row2">
        <div><label>Pot size cm</label><input name="potSize" type="number" min="5" max="40" step="1" value="15"></div>
        <div><label>Light level</label>
          <select name="lightLevel"><option value="medium">Medium</option><option value="bright">Bright</option><option value="low">Low</option></select>
        </div>
      </div>

      <div class="row2">
        <div><label>Water schedule</label>
          <select name="scheduleMode"><option value="suggested">Suggested</option><option value="custom">Custom</option></select>
        </div>
        <div><label>Custom interval days</label><input name="customIntervalDays" type="number" min="2" max="60" value="10"></div>
      </div>

      <div class="row2">
        <div><label>Water time (local)</label><input name="preferredWaterTime" type="time" value="09:00"></div>
        <div><label>Fertilizer interval days</label><input name="fertilizerIntervalDays" type="number" min="7" max="180" value="30"></div>
      </div>

      <menu>
        <button type="button" id="deletePlantBtn" class="btn ghost" style="margin-right:auto; display:none">Delete</button>
        <button type="button" id="cancelBtn" class="btn ghost">Cancel</button>
        <button type="submit" class="btn primary">Save</button>
      </menu>
    </form>
  </dialog>

  <dialog id="addRoomDialog">
    <form id="addRoomForm" method="dialog">
      <h3>Add a Room</h3>
      <label>Room name</label>
      <input name="roomName" required placeholder="Bedroom">
      <label>Choose icon</label>
      <div class="iconGrid" id="iconGrid"></div>
      <menu>
        <button type="button" id="addRoomCancel" class="btn ghost">Cancel</button>
        <button type="submit" class="btn primary">Save</button>
      </menu>
    </form>
  </dialog>

  <dialog id="editRoomDialog">
    <form id="editRoomForm" method="dialog">
      <h3>Edit a Room</h3>
      <label>Select room</label>
      <select name="roomToEdit" id="roomEditSelect"></select>
      <label>New name</label>
      <input name="newRoomName" placeholder="New name">
      <label>Choose new icon</label>
      <div class="iconGrid" id="iconGridEdit"></div>
      <menu>
        <button type="button" id="editRoomCancel" class="btn ghost">Cancel</button>
        <button type="submit" class="btn primary">Save</button>
      </menu>
    </form>
  </dialog>

  <dialog id="removeRoomDialog">
    <form id="removeRoomForm" method="dialog">
      <h3>Remove a Room</h3>
      <label>Select room to remove</label>
      <select name="roomToRemove" id="roomRemoveSelect"></select>
      <p class="meta">Plants in the removed room will move to Unassigned.</p>
      <menu>
        <button type="button" id="removeRoomCancel" class="btn ghost">Cancel</button>
        <button type="submit" class="btn primary">Remove</button>
      </menu>
    </form>
  </dialog>

  <dialog id="editPlantChooser">
    <form id="editPlantChooserForm" method="dialog">
      <h3>Edit a Plant</h3>
      <label>Select plant</label>
      <select name="plantToEdit" id="plantEditSelect"></select>
      <menu>
        <button type="button" id="editPlantCancel" class="btn ghost">Cancel</button>
        <button type="submit" class="btn primary">Edit</button>
      </menu>
    </form>
  </dialog>

  <dialog id="removePlantDialog">
    <form id="removePlantForm" method="dialog">
      <h3>Remove a Plant</h3>
      <label>Select plant</label>
      <select name="plantToRemove" id="plantRemoveSelect"></select>
      <menu>
        <button type="button" id="removePlantCancel" class="btn ghost">Cancel</button>
        <button type="submit" class="btn primary">Remove</button>
      </menu>
    </form>
  </dialog>

  <script type="module" src="./app_cloud.js?v=12"></script>
</body>
</html>
